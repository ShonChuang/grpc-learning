<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>grpc-web 概念 | grpc 筆記 </title>
    <meta name="description" content="">
    
    
    <link rel="preload" href="/grpc-learning/assets/css/0.styles.eab3ed60.css" as="style"><link rel="preload" href="/grpc-learning/assets/js/app.726ce2e2.js" as="script"><link rel="preload" href="/grpc-learning/assets/js/2.0af5c980.js" as="script"><link rel="preload" href="/grpc-learning/assets/js/5.eeef0ea0.js" as="script"><link rel="prefetch" href="/grpc-learning/assets/js/3.ed61bc52.js"><link rel="prefetch" href="/grpc-learning/assets/js/4.fd9a20ea.js"><link rel="prefetch" href="/grpc-learning/assets/js/6.68120635.js"><link rel="prefetch" href="/grpc-learning/assets/js/7.fb02c542.js"><link rel="prefetch" href="/grpc-learning/assets/js/8.1c9e0161.js">
    <link rel="stylesheet" href="/grpc-learning/assets/css/0.styles.eab3ed60.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/grpc-learning/" class="home-link router-link-active"><!----> <span class="site-name">grpc 筆記 </span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/grpc-learning/" class="nav-link">首頁</a></div><div class="nav-item"><a href="https://github.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/grpc-learning/" class="nav-link">首頁</a></div><div class="nav-item"><a href="https://github.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/grpc-learning/" class="sidebar-link">grpc 相關網站</a></li><li><a href="/grpc-learning/Backend.html" class="sidebar-link">後端使用 grpc</a></li><li><a href="/grpc-learning/Frontend.html" class="active sidebar-link">前端使用 grpc</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/grpc-learning/Frontend.html#grpc-web-概念" class="sidebar-link">grpc-web 概念</a></li><li class="sidebar-sub-header"><a href="/grpc-learning/Frontend.html#實作官方範本" class="sidebar-link">實作官方範本</a></li><li class="sidebar-sub-header"><a href="/grpc-learning/Frontend.html#實作-vue-js-＆-grpc" class="sidebar-link">實作 Vue.js ＆ Grpc</a></li><li class="sidebar-sub-header"><a href="/grpc-learning/Frontend.html#envoy-代理伺服器" class="sidebar-link">Envoy 代理伺服器</a></li><li class="sidebar-sub-header"><a href="/grpc-learning/Frontend.html#參考連結" class="sidebar-link">參考連結</a></li></ul></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="grpc-web-概念"><a href="#grpc-web-概念" class="header-anchor">#</a> grpc-web 概念</h2> <p>前端專案要使用 grpc 需要透過 grpc-web 的方式來實作，Grpc-web 是2019年一月才發布的，目前版本是還是1.0，文章可以參考<a href="https://grpc.io/blog/state-of-grpc-web/" target="_blank" rel="noopener noreferrer">這裡<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，底下說明 grpc web 的一些基本概念。</p> <ul><li>概念圖解如下 (擷取於<a href="(https://grpc.io/blog/state-of-grpc-web/)">grpc blog</a> 文章)：</li></ul> <p><img src="https://grpc.io/img/grpc-web-proxy.png" alt="grpc-web-proxy.png"></p> <ul><li>中間需透過 grpc-web 代理伺服器做介接，文件上使用 <a href="https://www.envoyproxy.io/" target="_blank" rel="noopener noreferrer">Envoy<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 代理伺服器。</li> <li>目前在 grpc 1.0 還有些限制，如下表格：</li></ul> <table><thead><tr><th style="text-align:center;">Client / Feature</th> <th style="text-align:center;">Transport</th> <th style="text-align:center;">Unary</th> <th style="text-align:center;">Server-side streams</th> <th style="text-align:center;">Client-side &amp; bidirectional streaming</th></tr></thead> <tbody><tr><td style="text-align:center;">Improbable</td> <td style="text-align:center;">Fetc️h/XHR ️</td> <td style="text-align:center;">✔️</td> <td style="text-align:center;">✔️</td> <td style="text-align:center;">❌</td></tr> <tr><td style="text-align:center;">Google (grpcwebtext)</td> <td style="text-align:center;">XHR</td> <td style="text-align:center;">✔️</td> <td style="text-align:center;">✔️</td> <td style="text-align:center;">❌</td></tr> <tr><td style="text-align:center;">Google (grpcweb)</td> <td style="text-align:center;">XHR</td> <td style="text-align:center;">✔️</td> <td style="text-align:center;">❌</td> <td style="text-align:center;">❌</td></tr></tbody></table> <ul><li><p>解析表格內容：</p> <ul><li><strong>Improbable</strong> 是另外的一個 grpc 團隊<a href="https://improbable.io/blog/grpc-web-moving-past-restjson-towards-type-safe-web-apis" target="_blank" rel="noopener noreferrer">https://improbable.io/blog/grpc-web-moving-past-restjson-towards-type-safe-web-apis<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>在 <strong>grpc web format</strong> 有兩種模式可以設定：
<ul><li><strong>grpcwebtext</strong>：
<ul><li>Content-type : application/grpc-web-text</li> <li>封包加密為 base64-encoded</li> <li>支援位元與 Server 資料流方式定義</li></ul></li> <li><strong>grpcweb</strong>：
<ul><li>Content-type: application/grpc-web+proto</li> <li>封包為二進位格式</li> <li>只支援位元方式定義</li></ul></li></ul></li> <li>不同的傳輸方式：
<ol><li><strong>Fetch</strong> 參考 <a href="https://developer.mozilla.org/zh-TW/docs/Web/API/Fetch_API/Using_Fetch" target="_blank" rel="noopener noreferrer">https://developer.mozilla.org/zh-TW/docs/Web/API/Fetch_API/Using_Fetch<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><strong>XHR</strong> 參考 <a href="https://developer.mozilla.org/zh-TW/docs/Web/API/XMLHttpRequest" target="_blank" rel="noopener noreferrer">https://developer.mozilla.org/zh-TW/docs/Web/API/XMLHttpRequest<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ol></li> <li>grpc 可以定義四種 server 方法：<a href="https://grpc.io/docs/guides/concepts/" target="_blank" rel="noopener noreferrer">參考<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> <ol><li><strong>Unary(位元)</strong>：就如呼叫方法一樣，傳入，接收與回應都為單一資料</li> <li><strong>Server-side streams</strong>：伺服器端回應為資料流的方式(streams)</li> <li><strong>Client-streaming</strong>：客戶端接收資料流方式(streams)</li> <li><strong>Bidirectional streaming</strong>： 雙向資料流(client 傳送與 server 接受都使用資料流方式)</li></ol></li></ul></li> <li><p><a href="https://github.com/johanbrandhorst/grpc-web-compatibility-test" target="_blank" rel="noopener noreferrer">grpc-web-compatibility-test 兼容性<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></li></ul> <h4 id="rest-and-grpc"><a href="#rest-and-grpc" class="header-anchor">#</a> REST and Grpc</h4> <p><img src="https://miro.medium.com/max/6632/1*dKAOqZ-jLi4lcKzkKuZzfQ.png" alt="REST and Grpc"></p> <h2 id="實作官方範本"><a href="#實作官方範本" class="header-anchor">#</a> 實作官方範本</h2> <p>可以參考官網提供的方式 Docker Compose <a href="https://grpc.io/docs/tutorials/basic/web/" target="_blank" rel="noopener noreferrer">實作<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，照著步驟執行可以正確產生 grpc-web 的架構，
該範本架構如下。</p> <ul><li>server: node-server</li> <li>proxy: envoy</li> <li>client: js</li></ul> <p>與我要做的專案不一樣底下動手實作 vuejs + Grpc 專案 。</p> <h2 id="實作-vue-js-＆-grpc"><a href="#實作-vue-js-＆-grpc" class="header-anchor">#</a> 實作 Vue.js ＆ Grpc</h2> <h4 id="環境設定"><a href="#環境設定" class="header-anchor">#</a> 環境設定</h4> <ol><li>下載 <a href="https://github.com/grpc/grpc-web/releases" target="_blank" rel="noopener noreferrer">protoc-gen-grpc-web <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>套件</li> <li>下載完後將檔案名稱修改為 protoc-gen-grpc-web，並放入 c:\windows\system32 底下</li> <li>下載 Protocol 編譯器 <a href="https://github.com/protocolbuffers/protobuf/releases" target="_blank" rel="noopener noreferrer">https://github.com/protocolbuffers/protobuf/releases<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。向    下滑到檔案下載頁，下載 protoc-3.10.0-win64.zip Windows 用。</li> <li>解壓縮後把 bin/protoc.exe 檔案放入 c:\windows\system32 底下</li></ol> <h4 id="建立-vue-js-專案"><a href="#建立-vue-js-專案" class="header-anchor">#</a> 建立 vue.js 專案</h4> <ul><li>透過 vue cli 建立新的 vue 專案</li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> vue create vuegrpc
<span class="token comment"># 先選擇 default 範本</span>
</code></pre></div><ul><li>安裝 google-protobuf 與 grpc-web 套件</li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> <span class="token function">yarn</span> <span class="token function">add</span> google-protobuf grpc-web  <span class="token comment"># or npm install google-protobuf grpc-web </span>
</code></pre></div><ul><li>建立 Protos 資料夾，將後端 Protos 底下的 *.proto 檔案 copy 過來。<a href="./Backend">參考</a></li> <li>在 src/底下建立 services 資料夾。</li> <li>編譯 proto</li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> protoc --proto_path<span class="token operator">=</span>Protos --js_out<span class="token operator">=</span>import_style<span class="token operator">=</span>commonjs,binary:src/services <span class="token punctuation">\</span> 
 --grpc-web_out<span class="token operator">=</span>import_style<span class="token operator">=</span>commonjs,mode<span class="token operator">=</span>grpcwebtext:src/services weather.proto

</code></pre></div><p>可以在 services 資料夾底下發現 weather_grpc_web_pb.js 與 weather_pb.js 檔案</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>指令說明</p> <ul><li><p><strong>protoc</strong>  使用 protoc 編譯器，之前放在 c:\windows\system32 底下的編譯器，若你無法執行，記得重開 cmd 視窗</p></li> <li><p><strong>--proto_path=Protos</strong> 匯入 proto 所在的位置</p></li> <li><p><strong>--js_out=import_style=commonjs,binary:src/services</strong> 產生 *.pb.js 檔案，輸出至 src/services 底下</p></li> <li><p><strong>--grpc-web_out=import_style=commonjs,mode=grpcwebtext:src/services</strong> 產生 *_grpc_web_pb.js 檔案，輸出至 src/services 底下</p></li> <li><p><strong>weather.proto</strong> 要編譯的 proto 檔</p></li></ul></div> <ul><li>編輯 App.vue</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>
<span class="token keyword">import</span> <span class="token punctuation">{</span> MapFieldEntry<span class="token punctuation">,</span> WeatherReply<span class="token punctuation">,</span> WeatherRequest <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@/services/weather_pb'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> WeatherForecastClient <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@/services/weather_grpc_web_pb'</span><span class="token punctuation">;</span>

<span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 後面會用透過代理伺服器連線</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WeatherForecastClient</span><span class="token punctuation">(</span><span class="token string">'http//localhost:8080'</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getWeather</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>
methods<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  <span class="token function">getWeather</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
     <span class="token keyword">const</span> getRequest <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WeatherRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'getRequest'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>getRequest<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>client<span class="token punctuation">.</span><span class="token function">weatherForecast</span><span class="token punctuation">(</span>getRequest<span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> response</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'response'</span><span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'err'</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>目前為止已經把前端 vuejs + grpc 專案建立完成，最後我們還需要<a href="https://www.envoyproxy.io/" target="_blank" rel="noopener noreferrer">Envoy<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 代理伺服器，才能串起後端 API。</p> <div class="custom-block warning"><p class="custom-block-title">WARNING</p> <p>如果迫不及待想直接測試連線之前建立好的 ASP.Net Core Grpc 專案，應該會出現 CORS 相關的錯誤，不過這是好現象，代表你真的串接到後端 api 了。應該要慶祝一下了。另外還可以確認到我的前端專案是使用 http2 的方式呼叫 API。<a href="https://stackoverflow.com/questions/54091567/how-to-check-if-website-has-http-2-protocol-support" target="_blank" rel="noopener noreferrer">查看http2<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p><a href="https://juejin.im/post/5b88a4f56fb9a01a0b31a67e" target="_blank" rel="noopener noreferrer">http2 解釋<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></div> <h2 id="envoy-代理伺服器"><a href="#envoy-代理伺服器" class="header-anchor">#</a> Envoy 代理伺服器</h2> <p>我們將 envoy 部署到 Docker 中，先回到 ASP.Net Core 專案裡，在根目錄增加 envoy 資料夾，新增一個檔案，名稱一定要這個 『Dockerfile』。</p> <ul><li>撰寫 Dockerfile</li></ul> <div class="language-docker extra-class"><pre class="language-docker"><code>
 <span class="token keyword">From</span>  envoyproxy/envoy<span class="token punctuation">:</span>latest
 <span class="token keyword">COPY</span> envoy.yaml /etc/envoy/envoy.yaml
 <span class="token keyword">CMD</span> /usr/local/bin/envoy <span class="token punctuation">-</span>c /etc/envoy/envoy.yaml <span class="token punctuation">-</span>l trace <span class="token punctuation">-</span><span class="token punctuation">-</span>log<span class="token punctuation">-</span>path /tmp/envoy_info.log

</code></pre></div><ul><li>撰寫 envoy 設定檔，資料夾底下新增 『envoy.yaml』檔案。</li></ul> <div class="language-yaml extra-class"><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><br></div><pre class="language-yaml"><code><span class="token key atrule">admin</span><span class="token punctuation">:</span>
  <span class="token key atrule">access_log_path</span><span class="token punctuation">:</span> /tmp/admin_access.log
  <span class="token key atrule">address</span><span class="token punctuation">:</span>
    <span class="token key atrule">socket_address</span><span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token key atrule">address</span><span class="token punctuation">:</span> 0.0.0.0<span class="token punctuation">,</span> <span class="token key atrule">port_value</span><span class="token punctuation">:</span> <span class="token number">9901 </span><span class="token punctuation">}</span>

<span class="token key atrule">static_resources</span><span class="token punctuation">:</span>
  <span class="token key atrule">listeners</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> listener_0
    <span class="token key atrule">address</span><span class="token punctuation">:</span>
      <span class="token key atrule">socket_address</span><span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token key atrule">address</span><span class="token punctuation">:</span> 0.0.0.0<span class="token punctuation">,</span> <span class="token key atrule">port_value</span><span class="token punctuation">:</span> <span class="token number">8080 </span><span class="token punctuation">}</span>
    <span class="token key atrule">filter_chains</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">filters</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> envoy.http_connection_manager
        <span class="token key atrule">config</span><span class="token punctuation">:</span>
          <span class="token key atrule">codec_type</span><span class="token punctuation">:</span> auto
          <span class="token key atrule">stat_prefix</span><span class="token punctuation">:</span> ingress_http
          <span class="token key atrule">route_config</span><span class="token punctuation">:</span>
            <span class="token key atrule">name</span><span class="token punctuation">:</span> local_route
            <span class="token key atrule">virtual_hosts</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> local_service
              <span class="token key atrule">domains</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;*&quot;</span><span class="token punctuation">]</span>
              <span class="token key atrule">routes</span><span class="token punctuation">:</span>
              <span class="token punctuation">-</span> <span class="token key atrule">match</span><span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token key atrule">prefix</span><span class="token punctuation">:</span> <span class="token string">&quot;/&quot;</span> <span class="token punctuation">}</span>
                <span class="token key atrule">route</span><span class="token punctuation">:</span>
                  <span class="token key atrule">cluster</span><span class="token punctuation">:</span> echo_service
                  <span class="token key atrule">max_grpc_timeout</span><span class="token punctuation">:</span> 0s
              <span class="token key atrule">cors</span><span class="token punctuation">:</span>
                <span class="token key atrule">allow_origin</span><span class="token punctuation">:</span>
                <span class="token punctuation">-</span> <span class="token string">&quot;*&quot;</span>
                <span class="token key atrule">allow_methods</span><span class="token punctuation">:</span> GET<span class="token punctuation">,</span> PUT<span class="token punctuation">,</span> DELETE<span class="token punctuation">,</span> POST<span class="token punctuation">,</span> OPTIONS
                <span class="token key atrule">allow_headers</span><span class="token punctuation">:</span> keep<span class="token punctuation">-</span>alive<span class="token punctuation">,</span>user<span class="token punctuation">-</span>agent<span class="token punctuation">,</span>cache<span class="token punctuation">-</span>control<span class="token punctuation">,</span>content<span class="token punctuation">-</span>type<span class="token punctuation">,</span>content<span class="token punctuation">-</span>transfer<span class="token punctuation">-</span>encoding<span class="token punctuation">,</span>custom<span class="token punctuation">-</span>header<span class="token punctuation">-</span><span class="token number">1</span><span class="token punctuation">,</span>x<span class="token punctuation">-</span>accept<span class="token punctuation">-</span>content<span class="token punctuation">-</span>transfer<span class="token punctuation">-</span>encoding<span class="token punctuation">,</span>x<span class="token punctuation">-</span>accept<span class="token punctuation">-</span>response<span class="token punctuation">-</span>streaming<span class="token punctuation">,</span>x<span class="token punctuation">-</span>user<span class="token punctuation">-</span>agent<span class="token punctuation">,</span>x<span class="token punctuation">-</span>grpc<span class="token punctuation">-</span>web<span class="token punctuation">,</span>grpc<span class="token punctuation">-</span>timeout
                <span class="token key atrule">max_age</span><span class="token punctuation">:</span> <span class="token string">&quot;1728000&quot;</span>
                <span class="token key atrule">expose_headers</span><span class="token punctuation">:</span> custom<span class="token punctuation">-</span>header<span class="token punctuation">-</span><span class="token number">1</span><span class="token punctuation">,</span>grpc<span class="token punctuation">-</span>status<span class="token punctuation">,</span>grpc<span class="token punctuation">-</span>message
          <span class="token key atrule">http_filters</span><span class="token punctuation">:</span>
          <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> envoy.grpc_web
          <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> envoy.cors
          <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> envoy.router
  <span class="token key atrule">clusters</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> echo_service
    <span class="token key atrule">connect_timeout</span><span class="token punctuation">:</span> 0.25s
    <span class="token key atrule">type</span><span class="token punctuation">:</span> logical_dns
    <span class="token key atrule">http2_protocol_options</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token key atrule">lb_policy</span><span class="token punctuation">:</span> round_robin
    <span class="token key atrule">hosts</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> <span class="token key atrule">socket_address</span><span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token key atrule">address</span><span class="token punctuation">:</span> netcore<span class="token punctuation">-</span>server<span class="token punctuation">,</span> <span class="token key atrule">port_value</span><span class="token punctuation">:</span> <span class="token number">9090 </span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">]</span>
</code></pre></div><p>最後這一行就是 API 的位置與 Port，Proxy 的 Port 就是 8080。
address 我們用 componse 容器名稱取代實際位置，這個 port 為 9090。</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>為何是 9090 Port不是預設的 https 5001 port or http 5000 Port?</p> <p>在 grpc 中預設是走 http2 協定，所以是需要設定 TSL(<a href="https://zh.wikipedia.org/wiki/%E5%82%B3%E8%BC%B8%E5%B1%A4%E5%AE%89%E5%85%A8%E6%80%A7%E5%8D%94%E5%AE%9A" target="_blank" rel="noopener noreferrer">傳輸層安全性協定<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>)。當我們在偵錯(debug)模式中，為了測試，可以加入一段 code 就可以允許不安全的傳輸連線(<a href="https://docs.microsoft.com/zh-tw/aspnet/core/grpc/troubleshoot?view=aspnetcore-3.0#call-insecure-grpc-services-with-net-core-client" target="_blank" rel="noopener noreferrer">參考<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>),讓 client 端可以略過不受認證的 TSL 正確呼叫 grpc Server。</p> <p>但現在部署到 Docker 預設是正式(Production)模式，需要合法的 TSL 認證，當然就會造成呼叫不到 grpc Server 的狀況，出現如下訊息：</p> <p>『<strong>code: 14, message: &quot;upstream connect error or disconnect/reset before headers. reset reason: connection failure&quot;</strong>』</p> <p>為了方便測試，先忽略 TSL 的設定(之後有時間再補)，我先調整了 Kestrel Port 為 9090 :</p> <div class="language-csharp extra-class"><div class="highlight-lines"><br><br><br><br><br><div class="highlighted"> </div><br><br><br></div><pre class="language-csharp"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">IHostBuilder</span> <span class="token function">CreateHostBuilder</span><span class="token punctuation">(</span><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
            Host<span class="token punctuation">.</span><span class="token function">CreateDefaultBuilder</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">ConfigureWebHostDefaults</span><span class="token punctuation">(</span>webBuilder <span class="token operator">=&gt;</span>
                <span class="token punctuation">{</span>
                    webBuilder<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">UseStartup</span><span class="token punctuation">&lt;</span><span class="token class-name">Startup</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    webBuilder<span class="token punctuation">.</span><span class="token function">ConfigureKestrel</span><span class="token punctuation">(</span>kes <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> kes<span class="token punctuation">.</span><span class="token function">ListenAnyIP</span><span class="token punctuation">(</span><span class="token number">9090</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre></div></div> <ul><li>建置 envoy docker image</li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> docker build -t grpc<span class="token punctuation">\</span>envoy <span class="token builtin class-name">.</span>

</code></pre></div><ul><li>正確建立完後，現在把 API 與 envoy 用 docker-compost 一起掛起來，在根目錄新增 docker-componse.yaml</li> <li>編輯 docker-componse.yaml</li></ul> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">'3'</span>
<span class="token key atrule">services</span><span class="token punctuation">:</span>

 <span class="token key atrule">netcore-server</span><span class="token punctuation">:</span>
    <span class="token key atrule">build</span><span class="token punctuation">:</span>
      <span class="token key atrule">context</span><span class="token punctuation">:</span> ./
      <span class="token key atrule">dockerfile</span><span class="token punctuation">:</span> ./Dockerfile
    <span class="token key atrule">image</span><span class="token punctuation">:</span> grpc/grpcnetcoredemo
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token string">&quot;9090:9090&quot;</span>
 <span class="token key atrule">envoy</span><span class="token punctuation">:</span>
    <span class="token key atrule">build</span><span class="token punctuation">:</span>
      <span class="token key atrule">context</span><span class="token punctuation">:</span> ./
      <span class="token key atrule">dockerfile</span><span class="token punctuation">:</span> ./envoy/Dockerfile
    <span class="token key atrule">depends_on</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> netcore<span class="token punctuation">-</span>server
    <span class="token key atrule">image</span><span class="token punctuation">:</span> grpc/envoy
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token string">&quot;8080:8080&quot;</span>
    <span class="token key atrule">links</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> netcore<span class="token punctuation">-</span>server
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p><a href="https://zh.wikipedia.org/wiki/YAML" target="_blank" rel="noopener noreferrer">YAML<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 很注重語法非常儼僅，斷行或階層空格都有限制</p></div> <ul><li>啟動 docker-componse</li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token operator">&gt;</span> docker-compose up -d netcore-server envoy
</code></pre></div><p>如果要停止輸入 docker-compose down</p> <ul><li>測試前端專案透過 grpc-web 呼叫 envoy 在連線 .Net Core grpc API，回傳天氣的預報內容，如下：</li></ul> <p><img src="/grpc-learning/assets/img/demo3.79c9f456.png" alt="deom3"></p> <p>這樣就完成了，Vue.js(前端框架) + grpc-web 透過 envoy proxy 呼叫 .Net Coee grpc API 測試，並且透過 Docker Compose 把這個服務掛上。</p> <h2 id="參考連結"><a href="#參考連結" class="header-anchor">#</a> 參考連結</h2> <ul><li><a href="https://medium.com/@aravindhanjay/a-todo-app-using-grpc-web-and-vue-js-4e0c18461a3e" target="_blank" rel="noopener noreferrer">vuejs 專案使用 grpc<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> <ul><li>文章發表於 2018 年底，裡面的 envoy 代理伺服器的設定 yaml 會有問題</li></ul></li> <li><a href="https://www.yycaf.xyz/2019/05/23/grpc-web-net-core-server-demo/" target="_blank" rel="noopener noreferrer">使用 Net Core 3 + Grpc與前端專案<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>、<a href="https://github.com/sitsh/grpcWebDemo" target="_blank" rel="noopener noreferrer">github<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> <ul><li>2019/5 月的範本，envoy 設定有些問題，照著做還是失敗，在未實作 TSL 前還是失敗。</li></ul></li> <li><a href="https://github.com/johanbrandhorst/grpc-web-compatibility-test" target="_blank" rel="noopener noreferrer">grpc web 官網提供的測試範本<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://github.com/grpc/grpc-web/releases" target="_blank" rel="noopener noreferrer">grpc web套件下載<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://github.com/sitsh/grpcWebDemo" target="_blank" rel="noopener noreferrer">grpc Error Code<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://www.zhihu.com/question/34074946" target="_blank" rel="noopener noreferrer">HTTP/2 相比 1.0 有哪些重大改进<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/grpc-learning/Backend.html" class="prev">後端使用 grpc</a></span> <!----></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/grpc-learning/assets/js/app.726ce2e2.js" defer></script><script src="/grpc-learning/assets/js/2.0af5c980.js" defer></script><script src="/grpc-learning/assets/js/5.eeef0ea0.js" defer></script>
  </body>
</html>
